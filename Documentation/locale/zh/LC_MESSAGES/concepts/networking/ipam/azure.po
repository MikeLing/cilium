# SOME DESCRIPTIVE TITLE.
# Copyright (C) Cilium Authors
# This file is distributed under the same license as the Cilium package.
# FIRST AUTHOR <EMAIL@ADDRESS>, 2022.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: Cilium \n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2022-05-25 23:56+0800\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=utf-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Generated-By: Babel 2.9.1\n"

#: ../../concepts/networking/ipam/azure.rst:3 d4e2670622ae48348694965d3178f689
msgid ""
"WARNING: You are looking at unreleased Cilium documentation. Please use "
"the official rendered version released here: https://docs.cilium.io"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:11 021fbb70c4e44deebb611b582437b3ef
msgid "Azure IPAM"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:13 d2f77e3195874eb996c2559d2f65e7b3
msgid ""
"The Azure IPAM allocator is specific to Cilium deployments running in the"
" Azure cloud and performs IP allocation based on `Azure Private IP "
"addresses <https://docs.microsoft.com/en-us/azure/virtual-network"
"/private-ip-addresses>`__."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:17 e48babf35a0f40c4a7f6fde6750b7753
msgid ""
"The architecture ensures that only a single operator communicates with "
"the Azure API to avoid rate-limiting issues in large clusters. A pre-"
"allocation watermark allows to maintain a number of IP addresses to be "
"available for use on nodes at all time without requiring to contact the "
"Azure API when a new pod is scheduled in the cluster."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:25 09050557f7b142d5b3db07b898355128
msgid "Architecture"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:30 5f514d048cce48d7bc552b324625d5d4
msgid ""
"The Azure IPAM allocator builds on top of the CRD-backed allocator. Each "
"node creates a ``ciliumnodes.cilium.io`` custom resource matching the "
"node name when Cilium starts up for the first time on that node. The "
"Cilium agent running on each node will retrieve the Kubernetes "
"``v1.Node`` resource and extract the ``.Spec.ProviderID`` field in order "
"to derive the `Azure instance ID <https://docs.microsoft.com/en-us/azure"
"/virtual-machine-scale-sets/virtual-machine-scale-sets-instance-ids>`__. "
"Azure allocation parameters are provided as agent configuration option "
"and are passed into the custom resource as well."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:38 741c8e23bf944a448c63250d031ab8ea
msgid ""
"The Cilium operator listens for new ``ciliumnodes.cilium.io`` custom "
"resources and starts managing the IPAM aspect automatically. It scans the"
" Azure instances for existing interfaces with associated IPs and makes "
"them available via the ``spec.ipam.available`` field. It will then "
"constantly monitor the used IP addresses in the ``status.ipam.used`` "
"field and allocate more IPs as needed to meet the IP pre-allocation "
"watermark. This ensures that there are always IPs available"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:48 207d464d442b41569a58093b97449acf
msgid "Configuration"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:50 aa8fee0102fb4a589060200196239881
msgid ""
"The Cilium agent and operator must be run with the option "
"``--ipam=azure`` or the option ``ipam: azure``  must be set in the "
"ConfigMap. This will enable Azure IPAM allocation in both the node agent "
"and operator."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:54 1f32379b4ac54575ae3c42a4b21c7fbf
msgid ""
"In most scenarios, it makes sense to automatically create the "
"``ciliumnodes.cilium.io`` custom resource when the agent starts up on a "
"node for the first time. To enable this, specify the option ``--auto-"
"create-cilium-node-resource`` or  set ``auto-create-cilium-node-resource:"
" \"true\"`` in the ConfigMap."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:60 cfd93f2cf78149bcb73a24b296729ac2
msgid ""
"It is generally a good idea to enable metrics in the Operator as well "
"with the option ``--enable-metrics``. See the section "
":ref:`install_metrics` for additional information how to install and run "
"Prometheus including the Grafana dashboard."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:66 143b28144e864b40937f9e7a12d173c9
msgid "Azure Allocation Parameters"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:68 449574df42f94d9294fe48f502f14e6b
msgid "The following parameters are available to control the IP allocation:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:76 2ad795f0e8c9452e86565b40c932ff9a
msgid "``spec.ipam.min-allocate``"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:71 8f04048827434d3ebf459a0905dd059a
msgid ""
"The minimum number of IPs that must be allocated when the node is first "
"bootstrapped. It defines the minimum base socket of addresses that must "
"be available. After reaching this watermark, the PreAllocate and "
"MaxAboveWatermark logic takes over to continue allocating IPs."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:76 7f5fc4e6570f43639b847bb8bb0edacb
msgid "If unspecified, no minimum number of IPs is required."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:83 a1e55531ee5e4f4c9a7db7b74bed099e
msgid "``spec.ipam.pre-allocate``"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:79 f83d1bb101ba4d96b90ec193eec86266
msgid ""
"The number of IP addresses that must be available for allocation at all "
"times.  It defines the buffer of addresses available immediately without "
"requiring for the operator to get involved."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:83 9c080dfa7ac64f5f94622575f9042f30
msgid "If unspecified, this value defaults to 8."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:90 ea0bfcf6a2374888b9eda93a4827a6c3
msgid "``spec.ipam.max-above-watermark``"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:86 cab7c3632ee44d5fba4bd2c511849991
msgid ""
"The maximum number of addresses to allocate beyond the addresses needed "
"to reach the PreAllocate watermark.  Going above the watermark can help "
"reduce the number of API calls to allocate IPs."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:90 97dbb225209e4c6ab4f1851f1a6a4dbd
msgid "If let unspecified, the value defaults to 0."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:94 038367556a9f4ab9ac50733b59478eb7
msgid "Operational Details"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:97 0614d956385743f29ee57dd9065bec50
msgid "Cache of Interfaces, Subnets, and VirtualNetworks"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:99 bd39f8673ba24a0a8789f29398f16378
msgid ""
"The operator maintains a list of all Azure ScaleSets, Instances, "
"Interfaces, VirtualNetworks, and Subnets associated with the Azure "
"subscription in a cache."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:102
#: 0171e7ef8ef5458abb1656b37bffb041
msgid ""
"The cache is updated once per minute or after an IP allocation has been "
"performed. When triggered based on an allocation, the operation is "
"performed at most once per second."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:107
#: db04a48f43b248f69766c237a6dd7203
msgid "Publication of available IPs"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:109
#: c49304b163754d5eb154f0fc30c22e5b
msgid ""
"Following the update of the cache, all CiliumNode custom resources "
"representing nodes are updated to publish eventual new IPs that have "
"become available."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:112
#: b43eb5196d3f4bd9aa1263e40dff21f3
msgid ""
"In this process, all interfaces are scanned for all available IPs.  All "
"IPs found are added to ``spec.ipam.available``. Each interface is also "
"added to ``status.azure.interfaces``."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:116
#: 65cac3866c924e52a64608a49303f78f
msgid ""
"If this update caused the custom resource to change, the custom resource "
"is updated using the Kubernetes API methods ``Update()`` and/or "
"``UpdateStatus()`` if available."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:121
#: 2ae39717e7024f7d9bb52c81b9041dcd
msgid "Determination of IP deficits or excess"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:123
#: e3d4b6683636432da76facbf9e6e1bc1
msgid ""
"The operator constantly monitors all nodes and detects deficits in "
"available IP addresses. The check to recognize a deficit is performed on "
"two occasions:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:126
#: b601a1bb2d7946c8bd13d0e1742d49ba
msgid "When a ``CiliumNode`` custom resource is updated"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:127
#: 4ab09d2b92654fc1b0ad4c017d913111
msgid "All nodes are scanned in a regular interval (once per minute)"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:129
#: 7c252f8455c94e3abc595b4efb42b7c1
msgid ""
"When determining whether a node has a deficit in IP addresses, the "
"following calculation is performed:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:136
#: b435e650e6d8451fbcd1eea8beacbf64
msgid "For excess IP calculation:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:142
#: 15334734513145da936ebdf344e10e15
msgid ""
"Upon detection of a deficit, the node is added to the list of nodes which"
" require IP address allocation. When a deficit is detected using the "
"interval based scan, the allocation order of nodes is determined based on"
" the severity of the deficit, i.e. the node with the biggest deficit will"
" be at the front of the allocation queue. Nodes that need to release IPs "
"are behind nodes that need allocation."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:149
#: a19a01c55cc74578b13422b3ee73affb
msgid "The allocation queue is handled on demand but at most once per second."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:152
#: 78e30f49c2a44b2596ce0d149f805b07
msgid "IP Allocation"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:154
#: feddd2749479404c8ebbb8127ba8741f
msgid ""
"When performing IP allocation for a node with an address deficit, the "
"operator first looks at the interfaces already attached to the instance "
"represented by the CiliumNode resource."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:158
#: 0f073f161f1247b9855f1ac0bce85762
msgid ""
"The operator will then pick the first interface which meets the following"
" criteria:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:161
#: 8715e6453e2a4c828fc5ce3cd3a4e64c
msgid ""
"The interface has addresses associated which are not yet used or the "
"number of addresses associated with the interface is lesser than `maximum"
" number of addresses <https://docs.microsoft.com/en-us/azure/azure-"
"resource-manager/management/azure-subscription-service-limits#networking-"
"limits>`__ that can be associated to an interface."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:167
#: 10e33c8fde1c4542b114816a2e8743db
msgid "The subnet associated with the interface has IPs available for allocation"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:169
#: 58c58789989141fd9f423eed835bc912
msgid ""
"The following formula is used to determine how many IPs are allocated on "
"the interface:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:176
#: bc86c5606a984291a1db5d874c9a4767
msgid ""
"This means that the number of IPs allocated in a single allocation cycle "
"can be less than what is required to fulfill ``spec.ipam.pre-allocate``."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:180
#: e458b44f605b40ab8ea5e8016f6db005
msgid "IP Release"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:182
#: b69b8f214bbd4f1ea7d1219e761f3702
msgid ""
"When performing IP release for a node with IP excess, the operator scans "
"the interface attached to the node. The following formula is used to "
"determine how many IPs are available for release on the interface:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:191
#: 0401ea2f123c4c0d87b03fd64be02483
msgid "Node Termination"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:193
#: bf10547f3b464d7c8d2f27a90d036ce4
msgid ""
"When a node or instance terminates, the Kubernetes apiserver will send a "
"node deletion event. This event will be picked up by the operator and the"
" operator will delete the corresponding ``ciliumnodes.cilium.io`` custom "
"resource."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:201
#: 7782be095f974fd4935e6a3885e23b75
msgid "Required Privileges"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:203
#: 18e91559ba0249cfb56ca00e342e83e9
msgid ""
"The following Azure API calls are being performed by the Cilium operator."
" The Service Principal provided must have privileges to perform these "
"within the scope of the AKS cluster node resource group:"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:207
#: da83e1cbb434411fa03c2ada8086dea8
msgid ""
"`Network Interfaces - Create Or Update <https://docs.microsoft.com/en-"
"us/rest/api/virtualnetwork/networkinterfaces/createorupdate>`__"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:208
#: e8304022540349e4b94aa8d9c331bcdd
#, python-format
msgid ""
"`NetworkInterface In VMSS - List Virtual Machine Scale Set Network "
"Interfaces <https://docs.microsoft.com/en-"
"us/rest/api/virtualnetwork/networkinterface%20in%20vmss/listvirtualmachinescalesetnetworkinterfaces>`__"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:209
#: 9e28cc7850204564b76b5deda88d4e98
msgid ""
"`Virtual Networks - List <https://docs.microsoft.com/en-"
"us/rest/api/virtualnetwork/virtualnetworks/list>`__"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:210
#: ad97f1b6cd1047c49025baded55e350a
msgid ""
"`Virtual Machine Scale Sets - List All <https://docs.microsoft.com/en-"
"us/rest/api/compute/virtualmachinescalesets/listall>`__"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:214
#: cca607b257ab4a54875b550f83d60442
msgid ""
"The node resource group is *not* the resource group of the AKS cluster. A"
" single resource group may hold multiple AKS clusters, but each AKS "
"cluster regroups all resources in an automatically managed secondary "
"resource group. See `Why are two resource groups created with AKS? "
"<https://docs.microsoft.com/en-us/azure/aks/faq#why-are-two-resource-"
"groups-created-with-aks>`__ for more details."
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:222
#: 4fab173e5f6847fba169f79e693425d8
msgid "Metrics"
msgstr ""

#: ../../concepts/networking/ipam/azure.rst:224
#: ab2dfbdda0c74a7ba2fd9be3e1b3f133
msgid "The metrics are documented in the section :ref:`ipam_metrics`."
msgstr ""

